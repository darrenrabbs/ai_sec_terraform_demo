<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'>
<title>AI Sec Report</title>
<style>
body {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  line-height: 1.6;
  margin: 20px;
  background-color: #f9f9f9;
  color: #333;
}

h1,
h2 {
  color: #2c3e50;
  margin-bottom: 15px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  background-color: white;
  border-radius: 5px;
  overflow: hidden;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

thead th {
  background-color: #34495e;
  color: white;
  padding: 12px;
  text-align: left;
  position: sticky;
  top: 0;
  z-index: 1;
  font-weight: bold;
}

td,
th {
  border: 1px solid #ddd;
  padding: 10px;
  font-size: 14px;
}

td {
  vertical-align: top;
}

tbody tr:nth-child(odd) {
  background-color: #f4f6f9;
}

tbody tr:nth-child(even) {
  background-color: #ffffff;
}

.severity-critical {
  background-color: #d9534f; /* Bright red */
  color: white;
  text-align: center;
}

.severity-high {
  background-color: #f0ad4e; /* Bright orange */
  color: white;
  text-align: center;
}

.severity-medium {
  background-color: #ffc107; /* Bright yellow */
  color: black;
  text-align: center;
}

.severity-low {
  background-color: #5bc0de; /* Bright blue */
  color: white;
  text-align: center;
}

.severity-warning {
  background-color: #f7c55f; /* Golden yellow */
  color: black;
  text-align: center;
}

a {
  color: #007bff;
  text-decoration: none;
  word-break: break-all;
}

a:hover {
  text-decoration: underline;
}

footer {
  text-align: center;
  margin-top: 30px;
  font-size: 12px;
  color: #7f8c8d;
}

.summary-table th,
.summary-table td {
  text-align: left;
  padding: 12px;
  border: 1px solid #ddd;
  font-size: 15px;
}

.summary-table th {
  background-color: #1abc9c;
  color: white;
}

.summary-table td:nth-child(2) {
  text-align: right;
}

.scrollable-table {
  max-width: 100%; /* Ensures it doesn't exceed the container width */
  overflow-x: auto; /* Adds horizontal scrollbar if needed */
  overflow-y: auto; /* Adds vertical scrollbar */
  border: 1px solid #ddd; /* Optional: To visually separate the table */
  border-radius: 5px; /* Matches the table's rounded corners */
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Adds shadow for aesthetics */
  margin: 20px 0; /* Adds spacing from other elements */
}

table {
  table-layout: auto; /* Adjust column width dynamically */
}

code {
  font-family: monospace;
  background-color: #eef2f7;
  padding: 2px 4px;
  border-radius: 3px;
}

</style>
</head>
<body>
<h1>AI Sec Report</h1>
<h2>Issue Summary</h2>
<div class='summary-table' style='width: 50%; margin: 0 auto;'>
<table>
<thead><tr><th>Severity</th><th>Count</th></tr></thead>
<tbody>
<tr style='background-color: #f5c6cb;'><td>Critical</td><td>0</td></tr>
<tr style='background-color: #ffe5b4;'><td>High</td><td>17</td></tr>
<tr style='background-color: #fff3cd;'><td>Medium</td><td>7</td></tr>
<tr style='background-color: #d4edda;'><td>Low</td><td>1</td></tr>
<tr style='background-color: #d1ecf1;'><td>Warning</td><td>2</td></tr>
</tbody></table></div>
<p style='text-align: center;'><strong>Total Linters:</strong> 3</p>
<p style='text-align: center;'><strong>Total Issues:</strong> 33</p>
<p style='text-align: center;'><strong>Linters Used:</strong> tflint, tfsec, checkov</p>
<div style='margin-top: 40px;'></div>
<h2>Lint Issues</h2>
<div class='scrollable-table'>
<table>
<thead><tr><th>LINTER</th><th>FILE</th><th>LINE</th><th>DESCRIPTION</th><th>SEVERITY</th><th>CONTEXT</th><th>LINKS</th></tr></thead>
<tbody>
<tr style='background-color: #d1ecf1;'>
<td>TFLint</td>
<td>main.tf</td>
<td>1</td>
<td>terraform "required_version" attribute is required</td>
<td>WARNING</td>
<td></td>
<td><a href="https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.10.0/docs/rules/terraform_required_version.md" target="_blank">https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.10.0/docs/rules/terraform_required_version.md</a></td>
</tr>
<tr style='background-color: #d1ecf1;'>
<td>TFLint</td>
<td>main.tf</td>
<td>10</td>
<td>Missing version constraint for provider "aws" in `required_providers`</td>
<td>WARNING</td>
<td></td>
<td><a href="https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.10.0/docs/rules/terraform_required_providers.md" target="_blank">https://github.com/terraform-linters/tflint-ruleset-terraform/blob/v0.10.0/docs/rules/terraform_required_providers.md</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>5</td>
<td>Instance with unencrypted block device.</td>
<td>HIGH</td>
<td>The issue, 'Instance with unencrypted block device', indicates that the storage associated with a certain instance in the Terraform pipeline isn't encrypted, thereby posing a potential security risk as any potential unauthorized access to the block device could lead to sensitive data exposure. As a remediation, it's recommended to enforce disk encryption consistently on all block devices related to the instance. Disk encryption can be enabled by setting the 'encrypted' argument to 'true' in the block device configuration section in the Terraform script. Additionally, make sure to enforce the use of secure encryption algorithms to ensure data integrity. Compliance should be validated periodically through automated security audits.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/ec2/enable-at-rest-encryption/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/ec2/enable-at-rest-encryption/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>5</td>
<td>aws_instance should activate session tokens for Instance Metadata Service.</td>
<td>HIGH</td>
<td>The identified high-severity issue signifies that the Amazon Web Services (AWS) instances in the Terraform framework are currently not using session tokens for their Instance Metadata Service (IMDS). This increases the risk of unauthorized access that can lead to privileged escalation and data breaches. To address this, it is crucial to enable IMDSv2 on AWS instances, which mandates session-orientation for enhanced security. This can be accomplished by configuring the instance metadata options in the Terraform script for AWS instances to require session tokens. This essential step of enforcing session tokens greatly improves the security posture by adding an extra layer of protection against unauthorized access.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/ec2/enforce-http-token-imds/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/ec2/enforce-http-token-imds/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 Access block should block public ACL</td>
<td>HIGH</td>
<td>This high-severity issue pertains to Amazon S3 bucket configurations within the Terraform framework. Briefly, when the block public access control list (ACL) setting isn't enforced for an S3 bucket, it leaves the bucket and its content exposed to potential threats, thereby allowing unauthorized access or potential data leakage. To rectify this issue, it's recommended to alter the S3 bucket policy by setting the 'block public ACL' attribute to 'true' within your Terraform code. This configuration ensures that the bucket disregards any public ACL requests, therefore, mitigating the risk of unauthorized access and fortifying the security of your data.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/block-public-acls/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/block-public-acls/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 Access block should block public policy</td>
<td>HIGH</td>
<td>The issue 'S3 Access block should block public policy' refers to an insecure configuration in Amazon S3 bucket settings, wherein public access is allowed, which could enable unauthorized users to access, modify, or delete data indiscriminately. To resolve this high-severity issue, the recommended best practice involves setting the 'BlockPublicPolicy' argument value to 'true' within the AWS S3 bucket's public access block configuration in the Terraform code, hence, preventing the bucket's resource policies from granting public access.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/block-public-policy/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/block-public-policy/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>Unencrypted S3 bucket.</td>
<td>HIGH</td>
<td>The high-severity issue 'Unencrypted S3 bucket' indicates that sensitive data is being stored in AWS S3 buckets without any encryption, potentially exposing it to unauthorized access and security breaches. As a remedy, it is strongly recommended to enable server-side encryption on all S3 buckets to ensure the safety of data at rest. You can choose to use Amazon S3 managed keys (SSE-S3) or AWS Key Management Service (SSE-KMS) for this purpose. Additionally, a bucket policy should be enforced to deny any put request which does not include encryption, ensuring adherence to security standards.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-bucket-encryption/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-bucket-encryption/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 Bucket does not have logging enabled.</td>
<td>MEDIUM</td>
<td></td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-bucket-logging/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-bucket-logging/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 Data should be versioned</td>
<td>MEDIUM</td>
<td></td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-versioning/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-versioning/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 encryption should use Customer Managed Keys</td>
<td>HIGH</td>
<td>The issue refers to the inadequate security parameter configuration of Amazon S3 service in Terraform, wherein the current setup is utilizing default Amazon managed encryption keys, which could potentially risk data security. To mitigate this high-severity problem, it is highly recommended to shift towards adopting customer-managed keys (CMKs) for encryption. This change could be implemented by altering the encryption settings in the Terraform S3 bucket configuration code to use AWS Key Management Service (KMS) CMKs instead of simple AWS managed keys. This strategic move enhances data security as it provides granular control over the keys, including the provision to rotate, disable, and establish access management, directly contributing to the robustness of infrastructure security.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/encryption-customer-key/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/encryption-customer-key/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 Access Block should Ignore Public Acl</td>
<td>HIGH</td>
<td>The high-severity issue 'S3 Access Block should Ignore Public Acl' in the terraform framework refers to the situation in which the S3 bucket is not properly configured to restrict public access. When an Amazon S3 bucket ignores public ACL (Access Control List), it could potentially allow unidentified actors to access, manipulate, or delete sensitive data, resulting in a serious breach of data protection. For rectification, one should implement the AWS managed S3 Block Public Access feature using Terraform to override any existing policies or ACLs, thereby ensuring comprehensive protection against public accessibility. By updating the bucket policy and enforcing access controls so that the S3 bucket does not respond to anonymous requests, we can block accidental sharing and public access to prevent potential leaks or malicious activity.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/ignore-public-acls/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/ignore-public-acls/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>12</td>
<td>S3 Buckets not publicly accessible through ACL.</td>
<td>HIGH</td>
<td>The issue pertains to the access control lists (ACLs) for S3 buckets in the Terraform framework being incorrectly configured, resulting in the buckets not being publicly accessible. This can prevent vital operations from executing correctly and hinders external integrations that require this kind of access. The recommended solution to this problem involves modifying the ACL configuration to allow public access. This can be achieved by setting the 'acl' attribute to 'public-read' or 'public-read-write' for the desired S3 buckets, depending on the level of permission required. However, care must be taken to ensure that this modification does not inadvertently expose sensitive data stored in the buckets, as this could result in potential security risks.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/no-public-access-with-acl/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/no-public-access-with-acl/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 Access block should restrict public bucket to limit access</td>
<td>HIGH</td>
<td>In simple terms, the problem at hand refers to an oversight in the Amazon S3 bucket settings handled via Terraform, where the block designated to restrict general public access to the bucket is not properly configured. This allows potentially sensitive data to be exposed to unauthorized access, leading to a security breach. To rectify this, you need to adjust the Terraform scripts for the S3 bucket and enable the restriction settings. Particularly, incorporate the 'aws_s3_bucket_public_access_block' resource in your Terraform script, ensuring that the 'block_public_acls' and 'block_public_policy' arguments are set to 'true'. This action will effectively block public 'READ' and 'WRITE' access thereby securing your S3 bucket.</td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/no-public-buckets/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/no-public-buckets/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets¡" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets¡</a></td>
</tr>
<tr style='background-color: #d4edda;'>
<td>TFSec</td>
<td>main.tf</td>
<td>10</td>
<td>S3 buckets should each define an aws_s3_bucket_public_access_block</td>
<td>LOW</td>
<td></td>
<td><a href="https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/specify-public-access-block/" target="_blank">https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/specify-public-access-block/</a><br><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>Ensure Instance Metadata Service Version 1 is not enabled</td>
<td>HIGH</td>
<td>This high-severity issue pertains to the use of instance metadata service (IMDS) version 1, which has certain security vulnerabilities such as open to SSRF (Server Side Request Forgery) attacks, where a malicious actor could obtain instance metadata and use it illicitly. To address this situation, it's critical to deactivate IMDS version 1 and replace it with IMDS version 2 in the terraform framework. IMDS Version 2 implements important defense mechanisms such as session-oriented requests and leveraging PUT requests to generate tokens, providing a secure layer for instance metadata interactions.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>Ensure that EC2 is EBS optimized</td>
<td>MEDIUM</td>
<td>The issue addresses the requirement of optimizing Amazon Elastic Compute Cloud (EC2) instances for Elastic Block Store (EBS), which provides block-level storage volumes for EC2. This is to ensure optimal performance and avoid data latency. If not implemented, it can severely impact storage and data retrieval efficiency, slowing down applications and impacting overall service provided by the organization's resources. To fix this issue, ensure you enable 'EBS-optimized' option during the launch of EC2 instances. You can validate or modify this option from the AWS Management Console, AWS CLI, or through AWS SDKs. For existing instances, stop the instance first, modify the EBS optimization settings, and then restart the instance. This will enhance performance and prevent issues related to data latency.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>Ensure that detailed monitoring is enabled for EC2 instances</td>
<td>MEDIUM</td>
<td>The high-severity issue within the Terraform framework, 'Ensure that detailed monitoring is enabled for EC2 instances', pertains to the lack of comprehensive, real-time, data monitoring for Amazon EC2 instances. This leaves the infrastructure vulnerable as any irregularities or potential security breaches may go unnoticed due to the coarse monitoring level. To resolve this, it is recommended to enable detailed monitoring on all EC2 instances. This can be done by adjusting the 'monitoring' attribute in the Terraform AWS Instance configuration to 'true', which will enable detailed monitoring at one-minute intervals, enhancing the ability to promptly identify and address potential issues or abnormal activities.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted</td>
<td>HIGH</td>
<td>The high severity issue you are encountering is related to data security on your Amazon Elastic Block Store (EBS) volumes involved in the launch configuration or instance of your infrastructure in Terraform. EBS volumes may currently be unencrypted, posing a serious threat as unauthorized users could potentially access sensitive data. To resolve this, enforce encryption on all EBS volumes to guard your data at rest. This can be achieved by setting the "encrypted" argument to 'true' on your AWS EBS resources within your terraform configuration file. Additionally, you can use AWS Key Management Service (KMS) for key management to further enhance your data security. Remember, auditing your Terraform scripts periodically for such vulnerabilities can prevent serious harm and data breaches.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure S3 buckets should have event notifications enabled</td>
<td>HIGH</td>
<td>This high-severity issue is related to the lack of event notifications on Amazon S3 buckets managed via the Terraform framework. The notifications can alert the system of any changes or actions conducted on the S3 buckets such as object creation, deletion or modification. This mechanism is critical to maintain the security and integrity of data stored within the buckets. To remedy the issue, it is recommended to configure event notifications within the Terraform deceleration for each S3 bucket. This can be done using the "bucket_notification" argument followed by the specific event types to track. Configuration must also include the necessary Amazon Simple Notification Service (SNS) or Amazon Simple Queue Service (SQS) to handle and appropriately respond to such notifications. Keep in mind that enabling event notifications can help significantly in detecting and addressing potential security issues promptly.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure the S3 bucket has access logging enabled</td>
<td>MEDIUM</td>
<td>The high-severity issue 'Ensure the S3 bucket has access logging enabled' implies that the S3 bucket currently in use does not have its user activity tracking enabled. This might engender security breaches as any uninhibited access to the bucket's data or unscrupulous data modification can go unnoticed. It's recommended to enable access logging for the S3 bucket in the Terraform configuration file. This will maintain a log of all access requests made to the S3 bucket, thereby assisting in auditing and analyzing the bucket's accesses. Any unauthorized or unusual activity can then be easily detected and responded to promptly, enhancing the overall security of the S3 bucket data.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure that S3 bucket has a Public Access block</td>
<td>HIGH</td>
<td>This high-severity issue relates to the security settings of your S3 bucket in AWS. S3 buckets can be set to allow public access which poses a risk as sensitive data may be unintentionally exposed, leading to data breaches. It is strongly advised that Public Access Block configurations are enabled on all S3 buckets to stop public access from being granted, both deliberately and inadvertently. To resolve this, enforce account-level and bucket-level settings to restrict public access either through the AWS management console or with the 'aws_s3_bucket_public_access_block' resource in your Terraform configuration, ensuring block_public_acls, block_public_policy, ignore_public_acls, and restrict_public_buckets attributes are set as 'true'.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure that S3 bucket has cross-region replication enabled</td>
<td>MEDIUM</td>
<td>The identified high-severity issue deals with the lack of cross-region replication for an S3 bucket in the Terraform framework. Cross-region replication is a critical feature that allows for the automatic, asynchronous duplication of data across buckets in different regions, offering redundancy and ensuring consistency of data. Neglecting to enable replication can result in data loss during unscheduled region outages, issues of accessibility, or other unforeseen complications. Therefore, to rectify this problem, it is advised to amend the Terraform script to include "aws_s3_bucket" resource and the appropriate replication configuration. This will enable cross-region replication, thereby enhancing the robustness and reliability of the data storage approach.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>S3 Bucket has an ACL defined which allows public READ access.</td>
<td>HIGH</td>
<td>The S3 Bucket with an ACL that allows public READ access implies that this bucket is currently exposed to the open internet, which poses a significant risk as unauthorized users can access and read the data stored within it. As a solution, you should modify the access control lists (ACLs) rule for the bucket to deny public access. Moreover, continuously monitor and audit your S3 buckets for any changes and ensure that any new buckets created follow this recommended practice to secure your data and prevent any potential leaks.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure that S3 buckets are encrypted with KMS by default</td>
<td>HIGH</td>
<td>The high-severity issue at hand spotlights the absence of server-side encryption with AWS Key Management Service (KMS) for S3 buckets, a crucial practice to protect and prevent unauthorized access to data at rest. To rectify this, it is recommended to enforce the use of AWS KMS for server-side encryption. Create a KMS key first to handle the encryption, then, adjust your Terraform scripts to include a server-side encryption configuration specifying the use of SSE-KMS and the KMS key ID created, under the aws_s3_bucket resource. This will ensure all future uploads into the S3 bucket will be encrypted by default, significantly enhancing the security of your stored data.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure all data stored in the S3 bucket have versioning enabled</td>
<td>HIGH</td>
<td>The high-severity issue points to data stored in the S3 bucket that lacks versioning, which is a security vulnerability. Versioning creates multiple versions of an object (file) within the S3 bucket, ensuring an extra layer of protection and data recovery when needed. Lack of versioning can lead to accidental deletions or overwriting with no way of restoration. To resolve this high-severity issue, it is recommended to change the S3 bucket's settings to enable versioning. This can typically be achieved by adding the 'versioning' block in the S3 bucket configuration within the terraform scripts, ensuring that any changes to individual objects in the bucket would be automatically versioned.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning</a></td>
</tr>
<tr style='background-color: #ffe5b4;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>Ensure an IAM role is attached to EC2 instance</td>
<td>HIGH</td>
<td>The high-severity issue pertains to an IAM (Identity and Access Management) role not being tied to an EC2 (Elastic Compute Cloud) instance in the terraform framework, creating a security vulnerability as potential actions on services will use EC2 instance credentials instead of individual user ones. This is precarious since it could enable unauthorized access if EC2 instance details are compromised. To resolve this, it is recommended to assign an IAM role to every EC2 instance during creation. By using IAM policies, you can clearly control permissions for any actions made on AWS services from EC2 instances, which will limit the scope of possible security breaches, therefore strengthening your overall infrastructure security.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance</a></td>
</tr>
<tr style='background-color: #fff3cd;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure that an S3 bucket has a lifecycle configuration</td>
<td>MEDIUM</td>
<td>The identified high-severity issue relates to the absence of a lifecycle configuration on an S3 bucket within the terraform framework. A lifecycle configuration is an important aspect of AWS S3 bucket management, as it automates tasks, such as transitioning data to cheaper storage classes as information becomes less relevant, or deletes objects over time, thus optimizing costs. This issue can compromise resource management and may lead to unnecessary costs or potential data unavailability. The recommended fix is to enforce a lifecycle policy on all S3 buckets to automatically handle object transition or expiration. By utilizing Terraform, you can define and provide lifecycle rules in the terraform configuration files while creating the S3 buckets, which will automatically enforce the lifecycle management on them.</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61</a></td>
</tr>
<tr style='background-color: #ffffff;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>1 - 3</td>
<td>Ensure no hard coded AWS access key and secret key exists in provider</td>
<td>UNKNOWN</td>
<td>PASSED</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5</a></td>
</tr>
<tr style='background-color: #ffffff;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>EC2 instance should not have public IP.</td>
<td>UNKNOWN</td>
<td>PASSED</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12</a></td>
</tr>
<tr style='background-color: #ffffff;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>5 - 8</td>
<td>Ensure no hard-coded secrets exist in EC2 user data</td>
<td>UNKNOWN</td>
<td>PASSED</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1</a></td>
</tr>
<tr style='background-color: #ffffff;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)</td>
<td>UNKNOWN</td>
<td>PASSED</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24</a></td>
</tr>
<tr style='background-color: #ffffff;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>S3 Bucket has an ACL defined which allows public WRITE access.</td>
<td>UNKNOWN</td>
<td>PASSED</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone</a></td>
</tr>
<tr style='background-color: #ffffff;'>
<td>Checkov</td>
<td>/main.tf</td>
<td>10 - 13</td>
<td>Ensure all data stored in the S3 bucket is securely encrypted at rest</td>
<td>UNKNOWN</td>
<td>PASSED</td>
<td><a href="https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest" target="_blank">https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest</a></td>
</tr>
</tbody></table>
</div>
<footer>
Report generated on <strong>2024-12-28 22:50:33</strong>
</footer>
</body></html>