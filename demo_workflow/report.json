{
    "summary": {
        "directory": "/github/workspace/s3_module",
        "linted_files": 3
    },
    "linters": {
        "tflint": [],
        "tfsec": [
            {
                "Linter": "TFSec",
                "File": "main.tf",
                "Line": 38,
                "Description": "Unencrypted S3 bucket.",
                "Severity": "HIGH",
                "Context": "The issue 'Unencrypted S3 bucket' within the terraform framework refers to a significant security risk where sensitive data stored on Amazon S3 buckets is not encrypted, making it vulnerable to unauthorized access and data breaches. To mitigate this problem, it is essential to enable server-side encryption on all S3 buckets by setting the 'aws_s3_bucket' argument 'server_side_encryption_configuration' within the terraform scripts. This action forces all objects within the bucket to be stored using the Secure Socket Layer (SSL) or Transport Layer Security (TLS), thus enhancing data protection. Ensuring compliance with this encryption policy will dramatically reduce the risk of sensitive data exposure.",
                "Links": [
                    "https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-bucket-encryption/",
                    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption"
                ]
            },
            {
                "Linter": "TFSec",
                "File": "main.tf",
                "Line": 38,
                "Description": "S3 Bucket does not have logging enabled.",
                "Severity": "MEDIUM",
                "Context": "",
                "Links": [
                    "https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-bucket-logging/",
                    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket"
                ]
            },
            {
                "Linter": "TFSec",
                "File": "main.tf",
                "Line": 38,
                "Description": "S3 Data should be versioned",
                "Severity": "MEDIUM",
                "Context": "",
                "Links": [
                    "https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/enable-versioning/",
                    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
                ]
            },
            {
                "Linter": "TFSec",
                "File": "main.tf",
                "Line": 38,
                "Description": "S3 encryption should use Customer Managed Keys",
                "Severity": "HIGH",
                "Context": "The issue 'S3 encryption should use Customer Managed Keys' draws attention to a security risk where the S3 buckets used in your infrastructure are not configured to use customer-managed keys (CMKs) for encryption, potentially compromising the safety of your data. By relying on standard AWS managed keys, control over the key lifecycle and security is limited. Consequently, to mitigate this high-severity issue, we recommend transitioning to customer-managed keys as they offer advanced security features. This can be accomplished by modifying the bucket policy in Terraform to include a reference to a KMS key that is customer-managed. Ensure the permissions correctly allow for the usage of the key, thereby bolstering the overall data security of your infrastructure. This practice enables streamlined management of keys, provides full control over their rotation, and offers extensive auditing through CloudTrail.",
                "Links": [
                    "https://aquasecurity.github.io/tfsec/v1.28.11/checks/aws/s3/encryption-customer-key/",
                    "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption"
                ]
            }
        ],
        "checkov": [
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "Ensure that EC2 is EBS optimized",
                "Severity": "MEDIUM",
                "Context": "The issue 'Ensure that EC2 is EBS optimized' refers to a non-compliance in the optimal configuration of the Amazon EC2 instances with EBS (Elastic Block Store) volumes. The problem comes from not enabling the EBS-optimized instance option that offers a separate network path for EBS volume I/O, resulting in improved performance of EC2 instances, a lower chance of network contention and interference, and more consistent disk I/O performance. The recommended resolution is to enable EBS-optimization status for all current and future EC2 instances to enjoy dedicated network capacity for data transfer between the instance and EBS. To do this, first check if your instance type supports EBS optimization, then enable it on your EC2 instances via the AWS Management Console, AWS CLI, or an AWS SDK. Enforce this behavior in infrastructural code by setting \"ebs_optimized = true\" in the Terraform AWS instance configuration block.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "Ensure that detailed monitoring is enabled for EC2 instances",
                "Severity": "MEDIUM",
                "Context": "The noted issue highlights that detailed monitoring is not enabled for the EC2 instances, compromising your ability to gather comprehensive and in-depth data about instance performance and troubleshoot accordingly. Without it, you're left exposed to potential system outages or performance degradation that can impact user experience or critical operational aspects without any detailed insights to aid problem identification. To rectify this issue, it is advisable to enable detailed monitoring on all your EC2 instances. This can be done within the Amazon Web Services (AWS) Management Console (or via AWS CLI) by navigating to your instance settings and enabling detailed monitoring under the CloudWatch Monitoring section. Enabling this provides instance data every minute instead of the standard five minutes, allowing for faster detection and response to issues or changes. Please note that additional charges may apply.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure S3 buckets should have event notifications enabled",
                "Severity": "MEDIUM",
                "Context": "The high-severity issue pertains to the absence of event notifications on S3 buckets within the terraform framework, meaning that operations carried out on the S3 bucket like PUT, POST, DELETE, or COPY will not trigger any notifications. This lack of sent alerts can lead to unauthorized activities going unnoticed, thus posing a potential threat to data security. The recommended resolution involves configuring event notifications for all S3 buckets. This can be achieved by using the 'notification_configuration' block in your terraform script to specify the events you wish to receive notifications for and the necessary responders (like Lambda functions, SNS topics, or SQS queues). By doing so, any activity on the S3 bucket will be reported, enhancing visibility and thereby contributing to improved data security.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure the S3 bucket has access logging enabled",
                "Severity": "MEDIUM",
                "Context": "The high-severity issue 'Ensure the S3 bucket has access logging enabled' relates to the absence of auditing measures for access activities in the S3 bucket, thereby creating a significant security gap. Without access logging, it becomes a challenge to track and analyze accesses or changes to the S3 bucket, which in turn, makes it difficult to identify any breaches or unauthorized activities. To resolve this, it's advisable to set up access logging for all your S3 buckets by configuring the logging parameters in the S3 bucket policies within your terraform framework. This way, all the requests made to your S3 bucket are logged into another specified S3 bucket and it becomes easy to keep track of any activity in your buckets.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure that S3 bucket has cross-region replication enabled",
                "Severity": "MEDIUM",
                "Context": "The issue pertains to the lack of cross-region replication for S3 buckets in Amazon Web Services (AWS) exposed through the Terraform framework. Cross-region replication is a significant feature that ensures backup and easy availability of data by automatically replicating data across buckets in different regions. Without it, any region-specific failures or catastrophes could result in irreversible data loss. Therefore, it is highly recommended to enable cross-region replication for all S3 buckets through a Terraform script. To solve this, update your Terraform configuration file by incorporating the replication_configuration block in your aws_s3_bucket resource. This ensures that every bit of data that enters your S3 bucket is automatically replicated to another bucket, providing an effective disaster recovery strategy and mitigating potential region-specific risks. This approach aligns well with security best practices and infrastructure management.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure that S3 buckets are encrypted with KMS by default",
                "Severity": "HIGH",
                "Context": "This high-severity issue relates to the lack of default Server-Side Encryption (SSE) in S3 buckets using AWS Key Management Service (KMS). If the S3 buckets are not encrypted, it may leave sensitive data exposed and vulnerable to breaches, which can result in costly information or data loss. In order to resolve this, it\u2019s highly recommended to set a default encryption policy on S3 buckets via the Terraform AWS provider. By doing this, every new object in the bucket gets encrypted with AWS KMS, thereby significantly enhancing the security of stored data. Also, regularly audit your AWS environment to ensure that all S3 buckets are compliant with this encryption setting, thereby minimizing potential security risks.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure all data stored in the S3 bucket have versioning enabled",
                "Severity": "HIGH",
                "Context": "The issue points to a lack of versioning for the data stored in the S3 bucket, posing a serious risk as it limits the ability to retrieve previous versions of an object, or even recover a deleted object. Enabling versioning is crucial for maintaining the integrity and accessibility of data, as it allows for the preservation, retrieval, and restoration of every version of every object in the bucket. To resolve this, modify the S3 bucket versioning configuration in the Terraform scripts by adding or ensuring the presence of the versioning block in all aws_s3_bucket resources, and setting the \"enabled\" argument in this block to true. This will ensure all new objects added to the bucket will be versioned, thereby providing an additional layer of data protection.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "Ensure an IAM role is attached to EC2 instance",
                "Severity": "MEDIUM",
                "Context": "This high-severity issue implies that an EC2 instance is currently operating without an attached IAM role, thereby making it highly susceptible to unauthorized access. Given that IAM roles provide controlled, temporary access to your AWS services, this lack of security could create potential backdoors for threat activities. To rectify the issue, it is recommended to attach a predefined IAM role to the EC2 instance. This role should have minimal permissions needed to successfully perform its intended tasks. Always ensure to follow the principle of least privilege (PoLP) and conduct regular access reviews to avoid potential security risks.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure that an S3 bucket has a lifecycle configuration",
                "Severity": "MEDIUM",
                "Context": "The high-severity issue 'Ensure that an S3 bucket has a lifecycle configuration' in the terraform framework entails a significant lapse in the management of object storage which could lead to unnecessary costs and data management issues. Without a lifecycle configuration, data stored in the S3 bucket may persist indefinitely, leading to an overutilization of resources and potential data bloat. As a remedy, it's crucial to add a lifecycle policy to every S3 bucket. This policy will automate processes such as moving older, less accessed data to cost-effective storage options, or deleting data that is no longer needed. Applying a lifecycle policy ensures optimal data management, prevents unnecessary costs, enhances performance, and helps maintain a clean, manageable bucket. Terraform provides a 'aws_s3_bucket_lifecycle_configuration' resource where this configuration can be efficiently put in place.",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "Ensure Instance Metadata Service Version 1 is not enabled",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "EC2 instance should not have public IP.",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "21 - 35",
                "Description": "Ensure no hard-coded secrets exist in EC2 user data",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1",
                "Additional Context": "aws_instance.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "44 - 51",
                "Description": "Ensure S3 bucket has 'restrict_public_buckets' enabled",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22",
                "Additional Context": "aws_s3_bucket_public_access_block.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "44 - 51",
                "Description": "Ensure S3 bucket has ignore public ACLs enabled",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21",
                "Additional Context": "aws_s3_bucket_public_access_block.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "44 - 51",
                "Description": "Ensure S3 bucket has block public policy enabled",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20",
                "Additional Context": "aws_s3_bucket_public_access_block.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "44 - 51",
                "Description": "Ensure S3 bucket has block public ACLS enabled",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19",
                "Additional Context": "aws_s3_bucket_public_access_block.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "16 - 18",
                "Description": "Ensure no hard coded AWS access key and secret key exists in provider",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5",
                "Additional Context": "aws.default"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "S3 Bucket has an ACL defined which allows public READ access.",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "S3 Bucket has an ACL defined which allows public WRITE access.",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure that S3 bucket has a Public Access block",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached",
                "Additional Context": "aws_s3_bucket.example"
            },
            {
                "Linter": "Checkov",
                "File": "/main.tf",
                "Line": "38 - 41",
                "Description": "Ensure all data stored in the S3 bucket is securely encrypted at rest",
                "Severity": "UNKNOWN",
                "Context": "PASSED",
                "Links": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest",
                "Additional Context": "aws_s3_bucket.example"
            }
        ]
    }
}